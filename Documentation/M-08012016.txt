Enes,

 

It’s now getting increasingly difficult to read the code, since I have no mental map of how things are organized and how they fit together. Overall, its seems ok, but I really cannot check.

 

My suggestion is that you convert it to C# and see if you obtain the intended results. If something is incorrect, it should be able to be corrected easily, without losing the whole work, so the way now is to move forward.

 

Regards,

 

Delgado
